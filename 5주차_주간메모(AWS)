
5주차_주간 메모(AWS) (월~금)

*AWS 프리티어를 통해 계정을 만들고, 실습하도록 한다.
 루트사용자 계정생성 및 별칭 생성 - 리전을 서울로 변경 - MFA할당 및 설정- admin사용자 계정의 생성 - 리전을 서울로 변경 - MFA할당 및 설정 - 컴퓨팅 항목으로 이동 ( EC2 ) - 인스턴스의 시작 - 
*** 인스턴스 '종료'= 삭제이므로 필히 알것 // 서버를 없애지않고 끄려면 '중지' 

# 1. Amazon Web Services 개요
오늘230918부터는 AWS의 기초와 개요를 알아보는 시간을 가진다.
 컴퓨팅, 스토리지, 데이터베이스, 분석, 네트워킹, 모바일, 개발자 도구, 관리 도구, IoT, 보안 및 엔터프라이즈 애플리케이션을 비롯하여 광범위한 글로벌 클라우드 기반 제품을 몇 초 이내에 온디맨드(수요에 의한 만큼) 방식의 종량제 요금으로 제공

서비스형 인프라(IaaS)
서비스형 인프라(IaaS)에는 클라우드 IT의 기본 구성 요소가 포함되어 있어 일반적으로 네트워킹 기능, 컴퓨터(가상 또는 전용 하드웨어) 및 데이터 스토리지 공간에 액세스할 수 있습니다. IaaS는 IT 리소스에 대한 최고 수준의 유연성 및 관리 제어 기능을 제공하며 오늘날 많은 IT 부서 및 개발자에게 익숙한 기존 IT 리소스와 아주 유사합니다.
서비스형 플랫폼(PaaS)
서비스형 플랫폼(PaaS)을 사용하면 기본 인프라(대개 하드웨어 및 운영 체제)를 관리할 필요가 없으므로 조직은 애플리케이션 배포 및 관리에 집중할 수 있습니다. 즉, 애플리케이션 실행과 관련된 리소스 구매, 용량 계획, 소프트웨어 유지 관리, 패치 또는 다른 모든 획일적인 작업에 대한 부담을 덜어 더욱 효율적이 되도록해줍니다.
서비스형 소프트웨어(SaaS)
서비스형 소프트웨어(SaaS)는 서비스 공급자가 운영하고 관리하는 완제품을 제공합니다. 대부분의 경우 서비스로서의 소프트웨어라고 하면 최종 사용자 애플리케이션을 말합니다. SaaS를 사용하면 서비스가 유지관리되거나 기본 인프라가 관리되는 방식은 신경 쓸 필요가 없고 그 특정 소프트웨어를 어떻게 활용할 것인지만 생각하면 됩니다. SaaS 애플리케이션의 흔한 예는 이메일을 주고 받는 데 사용하는 웹 기반 이메일을들 수 있는데, 이 경우 이메일 제품에 추가되는 기능을 관리하거나 이메일 프로그램이 실행되는 기반인 서버및 운영 체제를 유지 관리할 필요가 없습니다.
########
#MFA (Multi - Factor Authentication)  : 다요소 인증(2차인증) 설정
 > 보안 자격증명 및 규정 준수 탭으로 이동.
 > MFA 디바이스 할당 
 > MFA 디바이스 선택
 > QR코드 표시
 > 스마트폰의 google authenticatior 추가
 > 내 보안 자격증명이 추가되었음.
'You can register up to 8 MFA devices of any combination of the currently supported MFA types with your AWS account root and IAM user. With multiple MFA devices, you only need one MFA device to sign in to the AWS console or create a session through the AWS CLI with that user.'
>로그아웃 후 재 로그인을 위해서는 root의 '별칭' 을 입력 후 admin의 id, pw를 입력해 접속

#인스턴스 시작 (EC2>인스턴스)
>MyServer-AWS-1 생성
>Quick start 로 Amazon Linux 확인
>Amazon linux 2023 AMI 가상머신 이미지 선택
>인스턴스 유형 정보 확인
 -키 페어(로그인) >새 키 페어 생성(MyServer-AWS-1) / RSA type/ .pem type/ 
 생성시 key file이 컴퓨터에 생성됨.
>네트워크 설정 확인
 -보안그룹 SSH 트래픽 허용
>스토리지 구성 (EBS)

생성 후 인스턴스 상태(default: 대기 중 > 실행 중)를 확인하기
>인스턴스에 연결
>EC2 인스턴스 연결
-사용자 이름 확인(default: ec2-user) > 퍼블릭ip 주소 백업 및 실행.
useradd test1 입력 시> permission denied가 뜸. >sudo useradd test1> access
[ec2-user@ip-172-31-35-115 ~]$ ls -l /home
total 0
drwx------. 3 ec2-user ec2-user 74 Sep 18 07:50 ec2-user
drwx------. 2 test1    test1    62 Sep 18 07:56 test1		생성
exit 후 좌측 상단 ec2를 클릭

#SSH로 인스턴스에 접속
EC2 대시보드 > 인스턴스 > 퍼블릭 IPv4주소를 확인 > 인스턴스에 연결> SSH 클라이언트 탭이동 > 
1. SSH 클라이언트를 엽니다.(XShell 클라이언트 이용)
2. 프라이빗 키 파일을 찾습니다. 이 인스턴스를 시작하는 데 사용되는 키는 MyServer-AWS-1.pem입니다.
3. 필요한 경우 이 명령을 실행하여 키를 공개적으로 볼 수 없도록 합니다.
 chmod 400 MyServer-AWS-1.pem
4. 퍼블릭 DNS을(를) 사용하여 인스턴스에 연결:
 ec2-~~~~~.ap-northeast-2.compute.amazonaws.com

<1-1. XShell 이동>
새로만들기> host에 공인ip 혹은 공인 DNS를 입력 (호스트) > 사용자인증
>ID: ec2-user (root x), 퍼블릭 키 설정 이동 후 가져오기로 .pem 파일을 가져오기
>MyServer-AWS-1 키가 있는것을 확인가능
>키가 있기 때문에 암호는 입력하지 않아도 됨
>연결하면 AWS LINUX에 원격접속 완료.

<1-2. 권한부여>		이단계는 ubuntu에서의 초기설정 방법과도 같다.
passwd root 를 입력하면 접근 불가
~]$ sudo passwd root	를 사용하면 가능
암호- aws로 설정
~]$ su - root 	로 root에 원격접속 가능.
~]# sudo grep wheel /etc/sudoers 		로 모든권한 부여
~]# grep wheel /etc/group			로 그룹을 확인
wheel:x:10:ec2-user				

#Session Manager 서비스

#EC2 직렬콘솔
활성화

#윈도우(Windows) 인스턴스의 경우
~인스턴스에 연결> RDP 클라이언트 탭
 원격데스크톱 (win r)
컴퓨터에 퍼블릭DNS 입력	이름 administrator 	입력
>암호입력은 RDP 클라이언트에서 표시된 암호를 ctrl v 
연결하여 원격으로 접속한다.


>>(월) 오늘은 아마존AWS에 접속해서 실습을 해봤다. 구글계정과 aws계정, 루트로그인과 MFA 인증및 설정, IAM 사용자 그룹설정 활용까지 생각해보면 좋을 듯 하다.

#######################################################################################################################

# AWS IAM
1. IAM 이란 Identity and Access Management 의 약자로, 누군가 어떤 리소스나 서비스를 사용할 수 있는지에 대해서 접근 레벨이나 권한관리 기능을 제공하는 서비스이다. 리전에 구애받지 않고 유니버설하게 설정된다.

데이터 엔지니어 team > S/W 엔지니어 team > 데이터 분석 team 별로 업무 분업화를 통해서 조직 내 유저에게 역할을 부여하게 된다.
유저, 그룹, 역할, 정책     네 가지로 나뉘며 각각의 특징이 있다.
 

#EC2 란
Elastic Compute cloud 의 약자이며, AWS에서 클라우드 공간에 크기가 유연하게 변경되는 가상서버 기능을 제공하는 서비스를 말한다. EC2는 인스턴스라고도 불리며, 내가 대여한 클라우드 공간에 가상 서버를 만들어서 AWS에서 제공하는 다양한 애플리케이션을 실행이 가능하다.
<특징> 
온- 디맨드 (On-Demand) 방식 : 소위 '쓴 만큼' 요금을 지불하는 방식의 서비스에 해당.
리저브드 (Reserved) 방식 : 장기 약정 방식 (1~3년) 선불 upfront로 비용을 지불하므로 개발			중에 상황이 변하지 않는다면 기간대비 저렴하다는 장점을 가진다
스팟 (Spot) 방식 : 인스턴스 가격을 입찰하여 구매할 수 있는 방법. 이는 즉 AWS의 장비의 		휴무상태가 많거나 사용하려는 고객이 적을 때, 시장 경제에 따라 입찰하게되		며 사용이 가능하다. 불확실성이 높음.

#EBS 란
Elastic Block Store 의 약자이며, 블록단위로 읽고 쓰는 저장장치들을 일컫는다. 

#EC2 실습 (2단계)
네트워크 및 보안
> 보안그룹 탭 
> 공장초기화* launch-wizard-1,2 
> 보안 그룹 삭제로 초기화 

> Default 세부정보 내 인바운드 규칙 확인 
> 서비스 -  네트워크 및 콘텐츠 전송 탭 
> *VPC 대시보드에 등록 > VPC 신규 탭   	*Virtual Private Cloud(VPC)
> IPv4 *CIDR (172.31.0.0/16)를 확인      *Classless Inter-Domain Routing(CIDR)
> 서브넷 ID는 각기 다르나, 탭의 VPC는 모두 동일함.
> 한편 IPv4 CIDR은 다른것을 알 수 있음.

> 인스턴스 탭 - 인스턴스 시작
> AMI - Windows Server(hvm)로 시작 
> 인스턴스 유형의 비용표도 확인.
 
>키페어 생성 (다운로드) 
>네트워크 설정 - 편집 - vpc - 서브넷을 172.31.0.0/20 으로 선택
>방화벽(보안그룹) - 기존 보안 그룹 선택>default vpc선택 
>인스턴스 시작 > 완료
+ AWS-Server-2를 다시 만들어서 총 두개의 인스턴스 만듦

>모든 인스턴스 보기에서 인스턴스 2개(AWS-Server-1,2가 실행 중) 가 활성화됨.
>퍼블릭 dns, 프라이빗 dns를 메모 및 복사
> 인스턴스에 연결 > RDP 클라이언트 탭
> 암호 가져오기 > 프라이빗 키 파일업로드
> 인스턴스 인바운드 규칙 편집 > 소스_Anywhere-ipv4 0.0.0.0 규칙추가 및 저장

> 원격 데스크탑으로 이동(PC_window R) >옵션 표시
> 컴퓨터 이름(서버1, 2 퍼블릭 DNS) / 사용자 이름 Administrator 
> 서버암호를 입력하면 원격접속이 가능.

총 두개의 원격 서버접속을 성공하였음.
서버1에서 서버2로 ping을 하면 전송되지 않는다.(default : 방화벽 차단)
>> CMD 창에서 netsh명령어를 사용하여 방화벽 규칙을 추가한다
advfirewall firewall add rule name="Ping" protocol=icmpv4:8,any dir=in action=allow
방화벽 규칙을 추가
다음 명령어를 사용하여 ICMP 프로토콜(편리하게도 "ping"은 ICMP를 사용합니다)을 허용하는 방화벽 규칙을 추가합니다.
OR
>Server manager을 열기 > Tools 
>Windows Defender Firewall with Advanced Security 탭
 
>Inbound Rules탭
>목록 중 File and Printer Sharing을 모두 블럭지정 후 규칙 활성화
 
(적어도 ICMPv4 , ICMPv6은 활성화하기)
>우측 서버2도 동일하게 설정
>이후 서로의 IP로 핑을 보내면 잘 보내지는 것을 알 수 있다.
~~
세번째 인스턴스 생성
> 네트워크 설정 > 서브넷 172.31.0.0/20으로 설정
> 보안그룹생성 및 이름 설정(자동)
>인바운드 보안 그룹규칙( TCP, 3389, 0.0.0.0/0 ) 을 확인.
 
*리눅스의 경우 SSH,   윈도우의 경우 RDP 유형에 해당한다.
>인스턴스 시작.

>접속 후 리부팅을하면 퍼블릭도메인과 IP가 재할당되므로, 유의하여야 한다.
>비용청구가 되지 않으려면 인스턴스의 중지를 꼭 하고 나오기
>인스턴스 종료(제거) 도 가능하다.
>스냅샷 기능을 으로 작업을 이을 수 있다.

>Server Manager의 대시보드에서 퀵스타트(Add roles and Features)선택
>Web Server 체크, Add Features  및 설치 진행.
 
>엣지 127.0.0.1로 접속
 

> 인스턴스>서버 1 우클릭 후 이미지 및 템플릿 탭에서 이미지생성
> "My-Win-Server-Image-2022"  / 설명- "IIS 설정 완료"
> 우측 하단에 이미지 생성(한글x)
> AMI를 생성하였음.

 
>새로운 인스턴스 시작
>애플리케이션 및 os이미지에서 이후로부터 "내 AMI"가 생겨서 선택이 가능
>사후작업이 필요없어진다. 

#######################################################################################################################

#아마존 리눅스 EC2 학습 예정
#우분투 EC2 학습 예정







