17주차 수요일 메모 Microsoft (Azure2)

# AZ-104T00A Administer Intersite Connectivity
사이트 간 관리 AZ-104T00A 연결성

학습 목표 ‒ 사이트 간 연결 관리

# VNet 피어링 구성
VNet 피어링 사용 결정
게이트웨이 전송 및 연결 요구 사항 결정
VNet 피어링 만들기
서비스 체인 사용 결정
 
-게이트웨이 전송 및 연결 요구 사항 결정
게이트웨이 전송을 통해 피어링된 가 상 네트워크가 게이트웨이를 공유 하고 리소스에 액세스할 수 있습니다.
피어링된 가상 네트워크에 VPN 게이트웨이가 필요하지 않습니다.
기본 VNet 피어링은 다음을 제공합니다. 완전한 연결성
*연결된 네트워크의 IP 주소 공간은 겹칠 수 없습니다.
 
>로컬피어링 리저널피어링 / 글로벌피어링 

-VNet 피어링 만들기
가상 네트워크 액세스 설정 허용
전달된 트래픽 설정 구성	
피어링 링크를 생성하고 "연결됨" 상태 로 표시해야 합니다.

-서비스 체이닝
사용자 정의 경로 및 서비스 체인을 활용하여 사용자 정의 라우팅 구현
네트워크 가상 어플라이언스 또는 VPN 게이트웨이를 사용하여 VNet 허브 구현
서비스 체인을 사용하면 하나의 가상 네트워크에서 가상 어플라이언스 또는 가상 네트워크 게이 트웨이로 트래픽을 전달할 수 있습니다.
피어링된 가상 네트워크에서 사용자 정의 경로를 경유한다.
 

Azure 네트워크 관리자 개요
Azure Virtual Network Manager는 구독 전체에서 가상 네트워크를 전역적으로 그룹화, 구성, 배 포 및 관리할 수 있는 관리 서비스입니다. Virtual Network Manager를 사용하면 네트워크 그룹을 정의 하여 가상 네트워크를 식별하고 논리적으로 분할할 수 있습니다 . 그런 다음 원하는 연결 및 보안 구성을 결정하고 이를 네트워크 그룹의 선택된 모든 가상 네트워크에 동시에 적용할 수 있습니다.
 

# 랩 05 - 사이트 간 연결 구현
랩 시나리오
Contoso는 보스턴, 뉴욕 및 시애틀 사무실에 메시 광역 네트워크 링크를 통해 연결된 데이터 센터를 보유하고 있으며 이들 사이는 완벽하게 연결되어 있습니다. Contoso의 온-프레미스 네트워크 토폴로지를 반영하고 해당 기능을 검증하는 랩 환경을 구현해야 합니다.
작업> 1. 랩 환경 프로비저닝 / 2. 로컬 및 글로벌 가상 네트워크 피어링 구성 / 3. 사이트간 연결 테스트 
 
VPN 게이트웨이 사용 결정
VNet 간 연결은 Azure 가상 네트워크 를 연결합니다. ‒ VNet 피어링 또는 사용자 지정
지점 및 사이트 간(사용자 VPN) 연결은 개별 장치를 Azure 가상 네트워크에 연결합니다.
사이트 간 연결은 온-프레미스 데이터 센터를 Azure 가상 네트워크에 연결합니다.

사이트 간 VPN 연결 생성
시간을 내어 네트워크 구성 을 신중하게 계획하세요.
온프레미스 부분은 사이 트 간을 구성하는 경우에 만 필요합니다.
항상 확인하고 연결 테스트

게이트웨이 서브넷 생성
게이트웨이 서브넷을 만들면 게이트웨이 VM이 게이트웨이 서브넷에 배포되고 필수 VPN 게이트웨이 설정 으로 구성됩니다. 게이트웨이 서브넷에는 IP 주소가 포함되어 있습니다. 가능하다면 /28 또 는 /27의 CIDR 블록을 사용하세요. 게이트웨이 서브넷에 다른 리소스(예: 추가 VM)를 배포하지 마세요.

VPN 게이트웨이 만들기
대부분의 VPN 게이트웨이는 경로 기반입니다. 선택한 게이트웨이 SKU는 보유할 수 있는 연결 수와 총 처리량 벤치 마크에 영향을 미칩니다. 게이트웨이 서브넷 - 공용 IP 주소가 필요합니다. VPN 게이트웨이 다음을 포함하는 가상 네트워크를 연결합니다. 프로비저닝하는 데 최대 45분이 걸릴 수 있습니다.

-가상 네트워크 피어링과 VPN 게이트웨이 비교(1/2)
Virtual Network 피어링 및 VPN 게이트웨이는 다음 연결을 지원합니다.
• 다양한 지역의 가상 네트워크 • 다양한 Azure Active Directory 테넌트의 가상 네트워크 • 다양한 Azure 구독의 가상 네 트워크 • 혼합된 Azure 배포 모델을 사용하는 가상 네트워크
 

~ enu powerpoint 05

enu powerpoint 06~ 

# AZ-104T00A Administer Network Traffic
학습 목표 - 네트워크 트래픽 관리 // lab 06 

네트워크 라우팅 및 끝점(엔드포인트) 구성
Review System Routes
Identify User-Defined Routes 
Demonstration – Custom Routing tables • Examine a Routing Example
Determine Service Endpoint Uses 
Identify Private Link Uses 
Summary and Resources

-시스템 경로 검토
시스템은 가상 머신, 온프레미스 네트워크 및 인터넷 간에 직접 네트워크 트래픽을 라우팅 합니다 .
VM간 트래픽 동일한 서브넷
서로다른 서브넷에 있는 VM간 동일한 가상네트워크
VM에서 인터넷으로의 데이터플로우
VM간 통신 (VNet 과 VPN)
사이트 간 ExpressRoute 통신을 통한 VPN게이트웨이 통신

-사용자 정의 경로 식별
경로 테이블에는 가상 네트워크에서 패킷을 라우팅하는 방법을 지정하는 경로라는 규칙 집합 이 포함되어 있습니다.

사용자 정의 경로는 사용자 지정입니다.
트래픽 흐름의 다음 홉을 지정하는 경로를 정의하여 네트워크 트래픽을 제어하는 경로

다음 홉은 가상 네트워크 게이트웨이, 가상 네트워크, 인터넷 또는 가상 어플라이언스가 될 수 있습 니다.

-서비스 끝점 사용 결정
엔드포인트는 특정 서비스에 대한 네트워크 액세스를 제한합니다. 서비스 엔드포인트 추가를 완료하 는 데 최대 15분이 걸릴 수 있습니다.

개인 링크 사용 식별
Azure의 서비스에 대한 비공개 연결. 트래픽은 Microsoft 네 트워크에 남아 있습니다.
공용 인터넷 접속 불가

온프레미스 및 피어링 네트워크 와의 통합

네트워크 내에서 보안 사고 가 발생하는 경우 매핑된 리소스 에만 액세스할 수 있습니다
 

$ Azure Load Balancer 구성
로드 밸런서 솔루션 선택
 

공용 로드 밸런서 구현
 
들어오는 트래픽의 공용 IP 주소 및 포트 번호를 VM 의 개인 IP 주소 및 포트 번호에 매핑하거나 그 반대 로 매핑합니다.
부하 분산 규칙을 적용하여 VM 또는 서비스 전반에 트래픽을 분산합니다.

내부 로드 밸런서 구현
공용 로드 밸런서 구현
들어오는 트래픽의 공용 IP 주소 및 포트 번호를 VM 의 개인 IP 주소 및 포트 번호에 매핑하거나 그 반대 로 매핑합니다.
부하 분산 규칙을 적용하여 VM 또는 서비스 전반에 트래픽을 분산합니다.

내부 로드 밸런서 구현
가상 네트워크 내부의 리소스 또는 VPN을 사용 하여 Azure 인프라에 액세스하는 리소스에 만 트래픽을 전달합니다.
프런트 엔드 IP 주소 및 가상 네트워크는 인터넷 엔드포인트에 직접 노출되지 않습니다.
가상 네트워크 내, 프레미스 간 가상 네트워크, 다중 계층 애플리케이션 및 LOB(기간 업 무) 애플리케이션에 대한 부하 분산을 지원합 니다.
 

부하 분산 장치 규칙 만들기
프런트엔드 IP 및 포트 조합을 백엔드 풀 및 포트 조합 집합에 매핑합니 다
규칙은 다음과 결합될 수 있습니다. NAT 규칙
NAT 규칙은 VM(또는 네트워크 인터페이스)에 명시적으로 연결되어 대상에 대한 경로를 완성합니다.
Azure 애플리케이션 게이트웨이 구성
애플리케이션 게이트웨이 구현
 
 

$ Azure Traffic Manager 살펴보기
애플리케이션 가용성 향상
애플리케이션 성능 향상
다운타임 없는 서비스 유지
하이브리드 애플리케이션 결합
복잡한 배포를 위한 트래픽 분산

• DNS를 사용하여 작동합니다. 가장 적절한 엔드포인트 에 대한 요청
• 다음을 기준으로 엔드포인트를 선택합니다. 구성된 트래픽 라우팅 방법
• 엔드포인트 상태 확인 및 자동 장애 조치 제공

Traffic Manager 라우팅 방법(1/5)
우선순위 라우팅> 성능 라우팅> 지리적 라우팅> 가중치 기반 라우팅
Traffic Manager 프로필 구성
엔드포인트 모니터링 구성_구성 페이지 열기 Traffic Manager 프로필의 경우
 
 
 

$ 네트워크 감시자 (Network Watcher)
다양한 네트워크 진단 및 모니터링 도구를 제공하는 지역 서비스
IP 흐름 확인으로 연결 문제 진단
다음 홉은 트래픽이 진행 중인지 올바르게 라우팅되는지 확인합니다.
VPN 진단은 게이트웨이 및 연결 문제를 해결합니다.
NSG 흐름 로그는 네트워크 보안 그룹을 통해 IP 트래픽을 매핑합니다.
연결 문제 해결은 원본 VM과 대상 간의 연결을 보여줍니다.
토폴로지는 리소스의 시각적 다이어그램을 생성합니다.
 



# 실습 06 ‒ 트래픽 관리 구현
네트워크 트래픽을 위한 허브 스포크 토폴로지를 구현하는 임무를 맡고 있습니다. 토폴로지에는 Azure Load Balancer 및 Azure Application Gateway가 포함되어야 합니다.

작업 1: 랩 환경 프로비저닝 / 2: 허브 및 스포크 네트워크 토폴로지 구성 / 3: 가상네트워크 피어링의 전이성 테스트 / 4: 허브 및 스포크 토폴로지에서 라우팅 구성 / 5: Azure 로드밸런서 구현/ 6:  Azure 애플리케이션 게이트웨이 구현
 



